---
import MainLayout from "../layout/MainLayout.astro";
---

<MainLayout>
    <div class=" flex items-center flex-col w-[100%] ">
        <h1 class="mt-10 font-bold text-3xl text-indigo-700">Register</h1>
        <form id="register-form" class="flex flex-col mt-10 p-10 border-2 border-indigo-700 rounded-3xl bg-white">
            <div class="flex justify-between mb-4">
                <label for="name" >First Name</label>
                <input required type="text" id="name" name="name" class="ml-4 w-[200px] border border-gray-400 rounded-lg px-2">
            </div>
            <div class="flex justify-between mb-4">
                <label for="lastname" >Last Name</label>
                <input required type="text" id="lastname" name="lastname" class="ml-4 w-[200px] border border-gray-400 rounded-lg px-2 ">
            </div>
            <div class="flex justify-between mb-4">
                <label for="birthday" >Birthday</label>
                <input required type="date" id="birthday" name="birthday" class="ml-4 w-[200px] border border-gray-400 rounded-lg px-2">
            </div>
            <div class="flex justify-between mb-4">
                <label for="email" >Email</label>
                <input required type="email" id="email" name="email" class="ml-4 w-[200px] border border-gray-400 rounded-lg px-2">
            </div>
            <div class="flex justify-between mb-4">
                <label for="password">Password</label>
                <input required type="password" id="password" name="password" class="ml-4 w-[200px] border border-gray-400 rounded-lg px-2">
            </div>
            <div class="flex justify-between mb-4">
                <label for="confpassword" >Confirm Password</label>
                <input required type="password" id="confpassword" name="confpassword" class="ml-4 w-[200px] border border-gray-400 rounded-lg px-2">
            </div>
            <div class="flex items-center justify-center mt-10">
                <button class="p-4 bg-indigo-700 border-2 border-transparent text-white hover:bg-white hover:text-indigo-700 hover:border-indigo-700 rounded-xl transition duration-300 shadow-lg shadow-indigo-500/50">Create Account</button>
            </div>
        </form>
    </div>
</MainLayout>


<script is:inline>
    const form = document.getElementById('register-form');
    form.addEventListener('submit', (e) => {
        e.preventDefault();
        const form = e.target;
        let usersArray = [];
        const newUser = {
            name: form.elements['name'].value,
            lastname: form.elements['lastname'].value,
            birthday: form.elements['birthday'].value,
            email: form.elements['email'].value,
            password: form.elements['password'].value,
            confpassword: form.elements['confpassword'].value,
            myFlats: [],
            favFlats: []
        }
        form.reset()
        saveUser(newUser);

    });

    function saveUser(user){
        
        const users = JSON.parse(localStorage.getItem('users'));
        console.log(users)
        if(users == null){
            const arrayUsers = [user]
            localStorage.setItem('users', JSON.stringify(arrayUsers));
        } else {
            users.push(user)
            localStorage.setItem('users', JSON.stringify(users));
        }
    }
</script>